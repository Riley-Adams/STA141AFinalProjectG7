for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
month
movies <- cbind(movies,month)
#libraries
library(dplyr)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
#remove rows containing NA
movies <- movies_original %>% na.omit()
dim(movies)
rownames(movies) <- 1:nrow(movies)
# create "month" using "released"
# a factor 1:12, indicating month of release
month <- numeric()
for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
movies <- cbind(movies,month)
movies <- cbind(movies,factor(month))
class(movies$month)
movies <- cbind(movies,as.factor(month))
class(movies$month)
movies <- cbind(movies,month)
movies$month <- as.factor(movies$month)
class(movies$month)
# remove variable we will not be using
movies <- movies[,-movies$released]
# remove variable we will not be using
movies <- movies[-movies$released]
# remove variable we will not be using
drops <- c("released","director","writer","star","company")
movies[, !(names(movies) %in% drops)]
#libraries
library(dplyr)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
#remove rows containing NA
movies <- movies_original %>% na.omit()
dim(movies)
rownames(movies) <- 1:nrow(movies)
# create "month" using "released"
# a factor 1:12, indicating month of release
month <- numeric()
for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
movies <- cbind(movies,month)
movies$month <- as.factor(movies$month)
# remove variable we will not be using
drops <- c("released","director","writer","star","company")
movies[, !(names(movies) %in% drops)]
class(movies$month)
# remove variable we will not be using
drops <- c("released","director","writer","star","company")
movies <- movies[, !(names(movies) %in% drops)]
ncol(movies)
#organize columns
organized <- c("name","rating","runtime","genre", "country", "month", "year", "votes", "score", "budget","gross")
length(organized)
#organize columns
organized <- c("name","rating","runtime","genre", "country", "month", "year", "votes", "score", "budget","gross")
movies <- movies[,organized]
length(movies$country[movies$country == "United States"])
length(movies$country[movies$country == "United States"]) / nrow(movies)
movies$gross / movies$budget
returnProf <-  movies$gross / movies$budget
returnProf <-  movies$gross / movies$budget
movies <- cbind(movies, returnProf)
class(movies)
# Libraries
library(dplyr)
require(ggplot2)
require(GGally)
require(lmtest)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
# Remove rows containing NA
movies <- movies[rowSums(is.na(movies)) == 0,]
# Create "month" using "released"
# A factor 1:12, indicating month of release
month <- numeric()
for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
# Libraries
library(dplyr)
require(ggplot2)
require(GGally)
require(lmtest)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
# Remove rows containing NA
movies <- movies[rowSums(is.na(movies)) == 0,]
# Create "month" using "released"
# A factor 1:12, indicating month of release
month <- numeric()
for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
# Remove rows containing NA
movies <- movies_original[rowSums(is.na(movies)) == 0,]
# Create "month" using "released"
# A factor 1:12, indicating month of release
month <- numeric()
for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
movies <- cbind(movies, month)
movies$month <- as.factor(movies$month)
# Here we can see almost 80% of the movies are from the US
# Considering IMDb is a US-based database, isolate to the US only
sum(movies$country == "United States")/dim(movies)[1]
movies <- movies[movies$country == "United States",]
movies <- movies[-c(8,9,10,11,14)]
#reorganize columns
organized <- c("name","rating","runtime","genre", "country", "month", "year", "votes", "score", "budget","gross")
movies <- movies[,organized]
# Libraries
library(dplyr)
require(ggplot2)
require(GGally)
require(lmtest)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
# Remove rows containing NA
movies <- movies_original[rowSums(is.na(movies)) == 0,]
# Create "month" using "released"
# A factor 1:12, indicating month of release
month <- numeric()
for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
movies <- cbind(movies, month)
movies$month <- as.factor(movies$month)
# Here we can see almost 80% of the movies are from the US
# Considering IMDb is a US-based database, isolate to the US only
sum(movies$country == "United States")/dim(movies)[1]
movies <- movies[movies$country == "United States",]
movies <- movies[-c(8,9,10,11,14)]
#reorganize columns
organized <- c("name","rating","runtime","genre", "month", "year", "votes", "score", "budget","gross")
movies <- movies[,organized]
returnProf <-  movies$gross / movies$budget
movies <- cbind(movies, returnProf)
class(movies)
# Libraries
library(dplyr)
require(ggplot2)
require(GGally)
require(lmtest)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
# Remove rows containing NA
movies <- movies_original[rowSums(is.na(movies)) == 0,]
# Create "month" using "released"
# A factor 1:12, indicating month of release
month <- numeric()
for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
movies <- cbind(movies, month)
movies$month <- as.factor(movies$month)
# Here we can see almost 80% of the movies are from the US
# Considering IMDb is a US-based database, isolate to the US only
sum(movies$country == "United States")/dim(movies)[1]
movies <- movies[movies$country == "United States",]
movies <- movies[-c(8,9,10,11,14)]
#reorganize columns
organized <- c("name","rating","runtime","genre", "month", "year", "votes", "score", "budget", "gross")
movies <- movies[,organized]
return_prop <-  movies$gross / movies$budget
movies <- cbind(movies, returnProf)
# Libraries
library(dplyr)
require(ggplot2)
require(GGally)
require(lmtest)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
# Remove rows containing NA
movies <- movies_original[rowSums(is.na(movies)) == 0,]
# Remove rows containing NA
movies <- movies_original[rowSums(is.na(movies_original)) == 0,]
# Libraries
library(dplyr)
require(ggplot2)
require(GGally)
require(lmtest)
# Import data
movies_original <- read.csv("movies.csv")
dim(movies_original)
# Remove rows containing NA
movies <- movies_original[rowSums(is.na(movies_original)) == 0,]
# Create "month" using "released"
# A factor 1:12, indicating month of release
month <- numeric()
for (i in 1:length(movies$released)){
if (grepl("January", movies$released[i])){
month[i] <- 1
}else if (grepl("February", movies$released[i])){
month[i] <- 2
}else if (grepl("March", movies$released[i])){
month[i] <- 3
}else if (grepl("April", movies$released[i])){
month[i] <- 4
}else if (grepl("May", movies$released[i])){
month[i] <- 5
}else if (grepl("June", movies$released[i])){
month[i] <- 6
}else if (grepl("July", movies$released[i])){
month[i] <- 7
}else if (grepl("August", movies$released[i])){
month[i] <- 8
}else if (grepl("September", movies$released[i])){
month[i] <- 9
}else if (grepl("October", movies$released[i])){
month[i] <- 10
}else if (grepl("November", movies$released[i])){
month[i] <- 11
}else{
month[i] <- 12
}
}
movies <- cbind(movies, month)
movies$month <- as.factor(movies$month)
# Here we can see almost 80% of the movies are from the US
# Considering IMDb is a US-based database, isolate to the US only
sum(movies$country == "United States")/dim(movies)[1]
movies <- movies[movies$country == "United States",]
movies <- movies[-c(8,9,10,11,14)]
#reorganize columns
organized <- c("name","rating","runtime","genre", "month", "year", "votes", "score", "budget", "gross")
movies <- movies[,organized]
return_prop <-  movies$gross / movies$budget
movies <- cbind(movies, returnProf)
return_prop <-  movies$gross / movies$budget
movies <- cbind(movies, return_prop)
min(movies$score)
which(movies == min(movies$score))
which(movies$score == min(movies$score))
movies$name[2933]
movies$name[which(movies$score == min(movies$score))]
ggpairs(movies)
ggpairs(movies[,-1])
ggpairs(movies[,-1])
?ggpairs
pairs(movies[,-1])
rownames(movies) <- 1:length(movies)
rownames(movies) <- 1:nrow(movies)
length(unique(movies$genre))
lm_num <- lm(score ~ ., data = movies_num)
ggpairs(movies[,-1])
movies_num <- movies[unlist(lapply(movies, is.numeric))]
movies_num <- movies_num[-c(2)]
cor(movies_num)
lm_num <- lm(score ~ ., data = movies_num)
summary(lm_num)
vif(lm_num)
# Libraries
require(dplyr)
require(ggplot2)
require(GGally)
require(lmtest)
require(car)
lm_num <- lm(score ~ ., data = movies_num)
summary(lm_num)
vif(lm_num)
summary(lm(score ~ runtime + votes + budget+gross, data = movies_num))
summary(lm(score ~ runtime + votes + budget, data = movies_num))
movies$rating[movies$rating=="Approved"]
unique(movies$rating)
unique(movies$name)
unique(movies$runtime)
unique(movies$genre)
unique(movies$score)
movies %>% filter(name == "Fight Club")
movies %>% filter(movies$name == "Fight Club")
movies$name[name == "Fight Club"]
movies$name[movies$name == "Fight Club"]
unique(movies$rating)
movies %>% filter(movies$rating == "")
for (i in 1:nrow(movies)){
if(movies$rating == "")
movies$rating[i] <- R
}
for (i in 1:nrow(movies)){
if(movies$rating[i] == "")
movies$rating[i] <- "R"
}
unique(movies$rating)
for (i in 1:nrow(movies)){
if(movies$rating[i] == "Not Rated")
movies$rating[i] <- "Unrated"
}
unique(movies$rating)
class(movies$year)
nrow(movies %>% filter(movies$year == 1980))
nrow(movies %>% filter(movies$year == 2020))
nrow(movies %>% filter(movies$year == 2010))
nrow(movies %>% filter(movies$year == 1990))
nrow(movies %>% filter(movies$year == 2018))
nrow(movies %>% filter(movies$year == 2085))
nrow(movies %>% filter(movies$year == 1985))
nrow(movies %>% filter(movies$year == 1986))
ncol(movies)
